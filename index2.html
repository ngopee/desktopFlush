<html>
    <head>
        <link rel="stylesheet" type="text/css" href="pref_style.css">
    </head>
    <body onload="init()">
        <h2 id="title"> Welcome to DesktopFlush </h2>
        <br>
        <p id="desc">
            We will help you remove all the crap from your desktop!
        </p>
        <br />
        Desktop Folder Name: <input type="text" placeholder="DesktopFlush" />

        <br>
        Number of Groups:

        <select name="numGroups" id="numGroupSelector">
            <option value="" disabled selected>Number of Groups</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>

        <br />

        <div id="windowNames">

        </div>

        <div id="foldersCheckbox">

        </div>

        <br />
        <button id="okButton" onclick="start()"> OK </button>
    </body>

    <script>
        const fse = require("fs-extra");
        const remote = require("electron").remote


        function init(){
            var folders = fse.readdirSync(remote.getGlobal('sharedObj').desktopPath).filter(function (f){
                return f[0]!='.';
            });

            var checkboxes = document.querySelector("#foldersCheckbox");

            document.getElementById('numGroupSelector').onchange = function() {
                var numOfGroups = this.value;
                checkboxes.innerHTML = "";

                var windowsDiv = document.querySelector("#windowNames");
                windowsDiv.innerHTML = "";

                for (var i = 0; i < numOfGroups; i++){
                    var windowNameInput = document.createElement("input");
                    windowNameInput.type = "text";
                    windowNameInput.setAttribute("placeholder", "Window " + (i+1));
                    windowNameInput.id = "windowName" + (i+1);
                    windowNameInput.className = "windowNameInput";
                    windowsDiv.appendChild(windowNameInput);
                }

                for (var i = 0; i < folders.length; i++){
                    var checkboxContainer = document.createElement("div");

                    for (var j = 0; j < numOfGroups; j++){
                        var checkBox = document.createElement("input");
                        checkBox.type="checkbox";
                        checkBox.value = folders[i];
                        checkBox.name = "Window" + j;
                        checkBox.id = "__" + folders[i] + "_Window" + j;
                        checkBox.className = "checkbox";
                        checkboxContainer.appendChild(checkBox);

                    }
                    var label = document.createElement("label");
                    label.htmlFor = "__" + folders[i];
                    label.innerHTML = folders[i];

                    checkboxContainer.appendChild(label);

                    checkboxes.appendChild(checkboxContainer);
                }
            };
        }

        function start(){
            var checkedBoxes = document.querySelectorAll('input[name=Window0]:checked');
            for (var i = 0; i < checkedBoxes.length; i++){
                console.log(checkedBoxes[i].value);
            }

        }


    </script>

</html>
